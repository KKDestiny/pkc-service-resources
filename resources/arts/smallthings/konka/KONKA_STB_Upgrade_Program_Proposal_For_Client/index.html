<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>STB Upgrade Program Proposal - KONKA</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.css" rel="stylesheet">
	
	<link href="img/structure/logo.ico" media="screen" rel="shortcut icon" type="image/​x-icon">
	
	<!-- Flow CSS/JS -->	
    <link href="css/flow.css" rel="stylesheet">
	<script src="js/flow_model.js"></script>
	
	<!-- Flow Data Config File -->	
	<script src="js/config/Config.js"></script>
	
	<script src="js/config/flow_data_otaUpgration_0.js"></script>
	<script src="js/config/flow_data_otaUpgration_1.js"></script>
	<script src="js/config/flow_data_otaUpgration_2.js"></script>
	<script src="js/config/flow_data_otaUpgration_3.js"></script>
	<script src="js/config/flow_data_otaUpgration_4.js"></script>
	<script src="js/config/flow_data_otaUpgration_5.js"></script>
	<script src="js/config/flow_data_otaUpgration_6.js"></script>
	<script src="js/config/flow_data_otaUpgration_7.js"></script>
	<script src="js/config/flow_data_otaUpgration_8.js"></script>
	
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	
  </head>
  
  
  <body style="margin-left:20px; color:#999">
  
	  <div class="col-md-12">
		  <div class="page-header">
			<h1><font color="#37aef2"><span id="flow_title"></span> </font></h1>
		  </div>
	  </div>

	  
	  <div class="col-md-3">
		<div class="list-group">
		  <a href="#" class="list-group-item disabled">
			<b><span class="glyphicon glyphicon-copyright-mark"></span> CATALOG</b>
		  </a>
		  <a id="flow0" onclick=changeFlow(0) class="list-group-item active" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Version Information</a>
		  <a id="flow1" onclick=changeFlow(1) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Upgrade Instructions</a>
		  <a id="flow2" onclick=changeFlow(2) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> STB Upgrade Range</a>
		  <a id="flow3" onclick=changeFlow(3) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Upgrade Steps</a>
		  <a id="flow4" onclick=changeFlow(4) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Hints during Upgrading</a>
		  <a id="flow5" onclick=changeFlow(5) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Special Problems and Solutions</a>
		  <a id="flow6" onclick=changeFlow(6) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Precautions</a>
		  <a id="flow7" onclick=changeFlow(7) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> NIT Descriptor</a>
		  <a id="flow8" onclick=changeFlow(8) class="list-group-item" style="cursor:pointer"><span class="glyphicon glyphicon-chevron-right"></span> Technical Support</a>
		</div>
	  </div>
	  
	  
	  <div class="col-md-9" style="border-left:solid #dfdfdf 1px; ">
		<div class="panel panel-default" id="step_panel">
		  <div class="panel-body">
			<div id="step_detail">
			
			</div>
		  </div>
		  <div class="panel-footer"><span class="glyphicon glyphicon-bullhorn"></span> Last Update: <span id="last_update"></span></div>
		</div>
	  </div>
	  
	  <div class="col-md-12">
		<br>
		<hr>
		<p class="text-center">© 2014~2016 · <a href="http://www.onelib.biz" target="blank">OneLib智库</a> · 分享知识和经验，打造精品智库平台</p>
		<br>
	  </div>
  
	<script>
		var PROCESS_TYPE_ARR = ["versioninfo","instruct","range","steps","hints","problems","precautions","NIT","techSupport"];
		
		var PROCESS_TYPE = "versioninfo";
		
		var LAST_UPDATE = "";
		var FLOW_TITLE = "";
		var FLOW_TITLE_DESC = "";
		var FLOW_DETAIL = "";
		var FLOW_STEPS = "";

		var totalStep = 0;
		var currIndex = 0;
		
		function changeFlow(index)
		{
			PROCESS_TYPE = PROCESS_TYPE_ARR[index];			
			if(""==PROCESS_TYPE)
				PROCESS_TYPE = PROCESS_TYPE_ARR[0];

			PageInit();
			dropFocusList();
			fucosList(index);
			
			returnToTop();
		}
		
		function initParams()
		{
			LAST_UPDATE = "";
			FLOW_TITLE = "";
			FLOW_TITLE_DESC = "";
			FLOW_DETAIL = "";
			FLOW_STEPS = "";

			totalStep = 0;
			currIndex = 0;
			
			if(PROCESS_TYPE == PROCESS_TYPE_ARR[0])	// Version info
			{
				LAST_UPDATE = VERSION_LAST_UPDATE;
				FLOW_TITLE = VERSION_TITLE;
				FLOW_TITLE_DESC = VERSION_TITLE_DESC;
		}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[1])	//Upgrade Instructions
			{
				LAST_UPDATE = INSTRUCT_LAST_UPDATE;
				FLOW_TITLE = INSTRUCT_TITLE;
				FLOW_TITLE_DESC = INSTRUCT_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[2])	//KONKA STB Upgrade Range
			{
				LAST_UPDATE = UPRANGE_LAST_UPDATE;
				FLOW_TITLE = UPRANGE_TITLE;
				FLOW_TITLE_DESC = UPRANGE_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[3])	// Upgrade Steps
			{
				LAST_UPDATE = STEPS_LAST_UPDATE;
				FLOW_TITLE = STEPS_TITLE;
				FLOW_TITLE_DESC = STEPS_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[4])	// Hints during Upgrading
			{
				LAST_UPDATE = HINTS_LAST_UPDATE;
				FLOW_TITLE = HINTS_TITLE;
				FLOW_TITLE_DESC = HINTS_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[5])	// Special Problems and Solutions
			{
				LAST_UPDATE = FAQ_LAST_UPDATE;
				FLOW_TITLE = FAQ_TITLE;
				FLOW_TITLE_DESC = FAQ_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[6])	// Precautions
			{
				LAST_UPDATE = PRECAUTION_LAST_UPDATE;
				FLOW_TITLE = PRECAUTION_TITLE;
				FLOW_TITLE_DESC = PRECAUTION_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[7])	// NIT Descriptor
			{
				LAST_UPDATE = NIT_LAST_UPDATE;
				FLOW_TITLE = NIT_TITLE;
				FLOW_TITLE_DESC = NIT_TITLE_DESC;
			}
			else if(PROCESS_TYPE == PROCESS_TYPE_ARR[8])	// Technical Support
			{
				LAST_UPDATE = TECH_LAST_UPDATE;
				FLOW_TITLE = TECH_TITLE;
				FLOW_TITLE_DESC = TECH_TITLE_DESC;
			}
		}
		
		function initFlowInfo()
		{	
			// Last Update
			document.getElementById("last_update").innerHTML = LAST_UPDATE;
			
			// Fix title
			document.getElementById("flow_title").innerHTML = FLOW_TITLE;
			
			// Fix process Descriptor
			document.getElementById("step_detail").innerHTML = FLOW_TITLE_DESC;
		}
		
		function configPanel()
		{
			if(0==currIndex)
			{
				document.getElementById("step_detail").innerHTML = FLOW_TITLE_DESC;
			}
			else
			{
				document.getElementById("step_detail").innerHTML = FLOW_DETAIL[currIndex-1];
			}
		}
		
		function getQueryString(name) 
		{
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
			var r = window.location.search.substr(1).match(reg);
			if (r != null) return unescape(r[2]); return null;
		}
		
		function PageInit()
		{
			initParams();
			initFlowInfo();
		}
		
		function convertDec2Hex(id)
		{
			var raw = document.getElementById(id).value;
			document.getElementById(id+"_converted").innerHTML = parseInt(raw).toString(16)+" (Hex Format)";
		}
		
		function reloadNITSample()
		{
			document.getElementById("nit_sample_place").innerHTML = NIT_SAMPLE;
		}
		
		function dropFocused(preStr_curr,preStr)
		{
			for(var i=0;i<15;i++)
			{
				document.getElementById(preStr+i).setAttribute("class","");
			}
			reloadNITSample();
		}
		
		function changeFocused(index)
		{
			var preStr_curr = "nit";
			var preStr = "shownit";
			var style = "line-f-error";
			dropFocused(preStr_curr,preStr)
			document.getElementById(preStr_curr+index).setAttribute("class",style);
			document.getElementById(preStr+index).setAttribute("class",style);
		}
		
		/* NIT Fix */
		function pad(num, n) {  
			var len = num.toString().length;  
			while(len < n) {  
				num = "0" + num;  
				len++;  
			}  
			return num;  
		}  
		
		function fixFreq()
		{
			var freq = document.getElementById("nit_freq").value;
			freq = freq*100000;
			return pad(parseInt(freq).toString(16), 8);
		}
		function fixBandwidth()
		{
			var bandwidth = document.getElementById("nit_bandwidth").value;
			if(bandwidth=="8")
			{
				return "03";
			}
			else if(bandwidth=="7")
			{
				return "13";
			}
			else if(bandwidth=="6")
			{
				return "23";
			}
		}
		function fixPID()
		{
			var pid = document.getElementById("nit_pid").value;
			return pid;
		}
		function fixUpgradeMode()
		{
			var mode = document.getElementById("nit_upgrade_mode").value;
			if(mode=="1")
			{
				return 1;
			}
			else if(mode=="2")
			{
				return 2;
			}
		}
		function fixPidAndMode(pid, mode)
		{
			var pidmode = pad(parseInt(pid).toString(2),12) + pad(parseInt(mode).toString(2),3);
			return parseInt(pidmode,2).toString(16);
		}
		function fixHvw()
		{
			var hwv = document.getElementById("nit_hwv").value;
			return hwv;
		}
		function fixSvw()
		{
			var swv = document.getElementById("nit_swv").value;
			return swv;
		}
		function fixSerialStart()
		{
			var serials = document.getElementById("nit_serial_start").value;
			return pad(parseInt(serials).toString(16), 8);
		}
		function fixSerialEnd()
		{
			var seriale = document.getElementById("nit_serial_end").value;
			return pad(parseInt(seriale).toString(16), 8);
		}
		function generateNIT()
		{
			var nit_part1 = "<span class='cd cd-rsv' title=\"OTA upgrade description flag. (reserved)\">A1</span><span class='cd cd-rsv' title=\"OTA upgrade description length. 39 bytes. (reserved)\">27</span><span class='cd cd-rsv' title=\"0x036F Manufacture ID. (reserved)\">036F</span><span class='cd cd-rsv' title=\"Terrestrial information description flag. (reserved)\">5A</span><span class='cd cd-rsv' title=\"Terrestrial information description length.11 bytes. (reserved)\">0B</span>";
			
			var freq = "<span class='cd cd-t2' title=\"0x0297C1E0= 435.00000MHz (Decimal)\">"+fixFreq()+"</span>";
			var bandwidth = "<span class='cd cd-t3' title=\"0x03(Hexadecimal, for bandwidth, 000---8M, 001---7M, 010---6M)\">"+fixBandwidth()+"</span>";
			
			var nit_part2 = "<span class='cd cd-rsv' title=\"reserved\">8122FFFFFFFF</span>";
			
			var pid = fixPID();
			var mode = fixUpgradeMode();
			var pidmode = "<span class='cd cd-t4' title=\"PID and upgrade mode, click to see details\">"+fixPidAndMode(pid,mode)+"</span>";
			
			var nit_part3 = "<span class='cd cd-rsv' title=\"Private data description length. 20 bytes. (reserved)\">14</span><span class='cd cd-rsv' title=\"Manufacture ID Ext. (reserved)\">75</span>";
			
			var hwv = "<span class='cd cd-t4' title=\"Hardware version (reserved)\">"+fixHvw()+"</span>";
			var swv = "<span class='cd cd-t2' title=\"Software Version (should be same as the software)\">"+fixSvw()+"</span>";
			var serials = "<span class='cd cd-t3' title=\"Start serial NO. (Hexadecimal)\">"+fixSerialStart()+"</span>";
			var seriale = "<span class='cd cd-t4' title=\"End serial NO. (Hexadecimal)\">"+fixSerialEnd()+"</span>";
			
			var nit_part4 = "<span class='cd cd-rsv' title=\"(reserved)\">000000C8</span>";
			
			document.getElementById("new_nit_desc").innerHTML = nit_part1 + freq + bandwidth + nit_part2 + pidmode + nit_part3 + hwv + swv + serials + seriale + nit_part4;
		}

		window.onload=function(){

			currIndex = 0;
			changeFlow(currIndex);
			PageInit();
			
		}
		
		
	</script> 

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery.js"></script>
	
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
	
  </body>
</html>